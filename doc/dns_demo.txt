This document has been updated to work for mininet 2.0

INSTALLING SLICK
----------------
1. VM Setup:
	- These instructions assume that you already have a mininet VM Image
	  running on VirtualBox.

	- It has been tested with the following image:
		http://onlab.vicci.org/mininet-vm/mininet-2.1.0p2-140718-ubuntu-14.04-server-amd64-ovf.zip
		OLD:https://github.com/downloads/mininet/mininet/mininet-2.0.0-113012-amd64-ovf.zip

	- Note that, since it is AMD64, if you are using an Intel machine,
	  you may have to modify your BIOS settings to turn on AMD
	  emulation

	- Also, you will want to be able to ssh into the mininet VM from
	  your host.  These resources may be helpful:
		http://www.youtube.com/watch?v=yNmv7GiHIKE
		http://dowdberry.blogspot.com/2013/07/virtualbox-host-only-networking.html

2. Code Download:
	- From within your mininet VM, in the default /home/mininet folder,
	  download the following:

		svn+ssh://svn.gtnoise.net/srv/svn/sdn_mb/middlesox/

    - This will download slick code and pox code that is required by slick.

3. Installing dependencies:
	- Run the following commands from within your mininet VM:

		$ cd ~/middlesox
		$ ./install-slick.sh

	- This will install various dependencies:
		* paramiko (for SSHv3 support)
		* scp.py module.
		* pcap (for shim)
		* rpyc (also for shim)
		* scapy (for p0f module)
		* pybloomfilter library
    	* other dependencies

	- The install-slick.sh script does not currently check exit
	  statuses; please scroll up and look for any failures, and address
	  accordingly (though, if your VM is set up correctly and you are
	  connected to the Internet, it should be fine).

	- As the script says at the end, add the following line to .bashrc
	  (or whatever shell you decide to use):

	    export PYTHONPATH=/home/mininet/middlesox/pox:/home/mininet/mininet/:/home/mininet/pox


RUNNING SLICK
-------------
The script to set up the topology and start running mininet treats our
controller as a "Remote Controller" (so as to play nice with mininet).  
When mininet starts up, it will try to contact the controller;
as a result, we need to start up the Slick controller (by means of
starting POX) first.

4. Starting the controller:
	- Open up a new terminal on your host machine and ssh into your
	  mininet VM (recall that the user/pass is mininet/mininet).

	- Running the following commands will start the Slick controller:

		$ cd middlesox/pox/pox/
		$ sudo ./pox.py --verbose host_tracker slick.slick_controller --application=TwoLoggers --query=details messenger slick.tcp_transport --tcp_address=192.168.56.101 --tcp_port=7790 samples.spanning_tree --forwarding=l2_multi_slick
    - Alternatively, you can bind to the NAT IP address in the root context (--tcp_address=192.168.56.101)

5. Starting the network:
	- Open up another terminal on your host machine and again ssh into
	  your mininet VM.  This time, be sure to include the -X option to
	  ssh so that you can open up xterms for the various mininet hosts.

	- Running the following script will create a network topology, and
	  will set up NAT so that mininet hosts can communicate with hosts
	  on the Internet. This script by default creates a tree topology
      and the fanout and depth of the tree can be specified with -f and -d 
      options respectively.:

		$ time sudo python internet_ssh_exp.py -i <interface> -d 2 -f 3 -s 192.168.57.104 -p 1 -k 60 -c exp.config -g s1
		Example:
		$ time sudo python internet_ssh_exp.py -i eth1 -d 2 -f 3 -s 192.168.57.104 -p 1 -k 60 -c exp.config -g s1

	 where <interface> is your virtual Ethernet interface that connects to the Internet and -s option
	 specified the IP address where element machines should connect with the controller. Please note
	 -i and -s are two different interfaces. -p option tell the experiment number to run.
	
	Specifying "-p 1" automatically starts ping command on one of the hosts
	in the network and pings www.google.com ten times. This command should result in logging
	of dns requests to the DNS server for www.google.com domain name, in file /tmp/dns_logX.

	- Once the experiment is completed it will drop the terminal into a mininet CLI.


6. Sanity checking the network
	- You should be able to ping hosts on the Internet from the mininet
	  hosts.  You do this from within the mininet CLI; the following
	  should return typical ping output:

		mininet> h1 ping google.com

7. Setting up the shim
	- If you flip back over to the controller terminal, you'll see that
	  it is failing to find middlebox machines on which to place
	  elements.  This is because the shims aren't running on the
	  mininet hosts yet.

	- Open up a terminal to h3:

		mininet> xterm h3

	- From this terminal, run:

		h3# python ~/middlesox/shim/shim.py

	  This will start the shim layer and will register h3 as a
	  middlebox so that slick controller can redirect traffic to this
	  middlebox.

    - You can optionally specify input and output interfaces (though the
      default should do the right thing)

	- This should print some debug output showing that it has
	  successfully connected to the Slick controller.  The Slick
	  controller should by now say that it has successfully installed
	  Logger.

8. Pinging hosts:
	- As a final test, you should be able to use h1 or h2 to ping
	  external hosts:

		mininet> h1 ping google.com

	- Please check:

		(1) that you get the ping replies back.
		(2) that h3:/tmp/dns_log has logged the DNS messages (i.e.,
			that the Logger element worked)

	  The dns_log file should have the DNS flows that are being sent
	  from host h1 or h2 to the Internet.

APPLICATIONS
------------

    You can now specify an application to run as a commandline option to pox.
    It goes after "slick_controller" and before "messenger".  For example, to
    run an application the tests out triggers:

		$ cd middlesox/pox/pox/
		$ sudo ./pox.py --verbose slick.slick_controller --application=TriggerAllUnitTest messenger slick.tcp_transport --tcp_address=0.0.0.0 --tcp_port=7790 samples.spanning_tree --forwarding=l2_multi_slick
        $ sudo ./pox.py --verbose host_tracker slick.slick_controller messenger slick.tcp_transport --tcp_address=0.0.0.0 --tcp_port=7790 samples.spanning_tree --forwarding=l2_multi_slick

    If no application is specified on the commandline, it will default to
    running the TwoLoggers application (which logs both port 53 and port 80
    traffic).

    As you develop new applications, please do the following:

        - Place them in ~/middlesox/pox/ext/slick/apps/
        - Name the file the same as the class (it is case sensitive for now)
        - Add the name of the app to ~/middlesox/pox/ext/slick/apps/__init__.py
        - Reflect the case sensitive naming in your applications .spec file

    Applications can be found in:
        ~/middlesox/pox/ext/slick/apps/

    Elements can be found in
        ~/middlesox/pox/ext/slick/elements/
